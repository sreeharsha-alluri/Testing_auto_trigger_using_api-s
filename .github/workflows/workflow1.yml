name: Workflow 1

on:
  push:
    branches:
      - main
  workflow_dispatch:  # Allows manual triggering of Workflow 1

jobs:
  run-echo:
    runs-on: ubuntu-latest
    steps:
      - name: Echo statement
        run: echo "Workflow 1 completed successfully"

      - name: Trigger Workflow 2
        env:
          GITHUB_TOKEN: ${{ secrets.PAT }}  # Make sure your Personal Access Token is stored as a secret
        run: |
          response=$(curl -X POST \
            -H "Authorization: Bearer $GITHUB_TOKEN" \
            -H "Accept: application/vnd.github.v3+json" \
            https://api.github.com/repos/sreeharsha-alluri/Testing_auto_trigger_using_api-s/actions/workflows/workflow2.yml/dispatches \
            -d '{"ref":"main"}' \
            -w "%{http_code}")
          echo "Response: $response"
